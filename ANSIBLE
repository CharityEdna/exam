sudo apt update
sudo apt install ansible -y

ansible --version


Step 2: Create the Custom HTML File
nano index.html


<!DOCTYPE html>
<html>
<head><title>Test Page</title></head>
<body><h1>Hello from Ansible!</h1></body>
</html>



Step 3: Create the Inventory File
nano inventory.ini
[webservers]
localhost ansible_connection=local ansible_python_interpreter=/usr/bin/python3



Role 1: webservices (handles Apache + MariaDB install/start/enable)

web_package: apache2
db_package: mariadb-server

---
- name: Update apt cache
  apt:
    update_cache: yes
    cache_valid_time: 3600

- name: Install web and database packages
  apt:
    name:
      - "{{ web_package }}"
      - "{{ db_package }}"
    state: present

- name: Start and enable Apache
  systemd:
    name: "{{ web_package }}"
    state: started
    enabled: yes

- name: Start and enable MariaDB
  systemd:
    name: "{{ db_package | regex_replace('-server', '') }}"
    state: started
    enabled: yes

Role 2: filedeploy (handles HTML copy)

---
- name: Ensure /var/www/html directory exists
  file:
    path: /var/www/html
    state: directory
    mode: '0755'
    owner: www-data
    group: www-data

- name: Copy custom index.html
  copy:
    src: index.html
    dest: /var/www/html/index.html
    owner: www-data
    group: www-data
    mode: '0644'

-------------------

- name: Deploy Web Stack with MariaDB
  hosts: localhost
  become: yes  # Run tasks with sudo
  vars:
    ansible_python_interpreter: /usr/bin/python3

  roles:
    - webservices
    - filedeploy

Step 5: Dry Run the Playbook (Syntax Check + Simulation)
ansible-playbook -i inventory.ini playbook.yml --check -v

Step 6: Run the Playbook for Real (Optional, for Testing)
ansible-playbook -i inventory.ini playbook.yml -v
